{% set internal = salt["pillar.get"]("psf_internal_network") %}

{
    "acl_datacenter": "{{ grains.dc }}",
    "acl_default_policy": "deny",
    "bind_addr": "{{ salt["ip_picker.ip_addrs"](cidr=internal)[0] }}",
    "bootstrap_expect": {{ pillar["consul"]["bootstrap-expect"] }},
    "ca_file": "/etc/consul/ca.pem",
    "cert_file": "/etc/consul/cert.pem",
    "datacenter": "{{ grains.dc }}",
    "disable_remote_exec": true,
    "enable_syslog": true,
    "key_file": "/etc/consul/cert.pem",
    "server": true,
    "verify_incoming": true,
    "verify_outgoing": true
}
