{% set internal = salt["pillar.get"]("psf_internal_network") %}

{
    "acl_datacenter": "{{ pillar.consul.acl.dc }}",
    "acl_default_policy": "{{ pillar.consul.acl.default }}",
    "acl_down_policy": "{{ pillar.consul.acl.down }}",
    "acl_ttl": "{{ pillar.consul.acl.ttl }}",
    "bind_addr": "{{ salt["ip_picker.ip_addrs"](cidr=internal)[0] }}",
    "ca_file": "/etc/consul.d/ca.pem",
    "cert_file": "/etc/consul.d/cert.pem",
    "datacenter": "{{ grains.dc }}",
    "disable_remote_exec": true,
    "enable_syslog": true,
    "key_file": "/etc/consul.d/cert.pem",
    "verify_incoming": true,
    "verify_outgoing": true
}
